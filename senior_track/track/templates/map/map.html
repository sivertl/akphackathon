{% load static %}
<!DOCTYPE html>
<html style="background-color: #ffffff;">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Home - Brand</title>
    <link rel="stylesheet" href="static/assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic">
    <link rel="stylesheet" href="static/assets/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="static/assets/fonts/simple-line-icons.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,300,700,400italic,300italic,700italic">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="static/assets/css/TR-Form.css">

    <script type="text/javascript" src="static/assets/Mapify/js/jquery/jquery.js"></script>
    <script type="text/javascript" src="static/assets/Mapify/js/jquery/jquery-ui.js"></script>
    <!--<script type="text/javascript" src="../libs/jquery.fs.zoetrope.min.js"></script> used for polyfill and polyline-->
    <script type="text/javascript" src="static/assets/Mapify/js/toe.min.js"></script>
    <script type="text/javascript" src="static/assets/Mapify-master/js/jquery.mousewheel.min.js"></script>
    <script type="text/javascript" src="static/assets/Mapify/js/imgViewer.min.js"></script>
    <script type="text/javascript" src="static/assets/Mapify-master/js/mapify.js"></script>
</head>


<body>
    <nav class="navbar navbar-light navbar-expand bg-light navigation-clean">
        <div class="container"><a class="navbar-brand" href="#">Track an elderly person</a><button class="navbar-toggler" data-toggle="collapse" data-target="#navcol-1"></button>
            <div class="collapse navbar-collapse" id="navcol-1">
                <ul class="nav navbar-nav">
                    <li class="nav-item" role="presentation"><a class="nav-link active" href="{% url 'base:home' %}">Home</a></li>
                    <li class="nav-item" role="presentation"><a class="nav-link" href="#addProfile">User profile</a></li>
                    <li class="nav-item" role="presentation"><a class="nav-link" href= "{% url 'base:map' %}">Map</a></li>
                    <li class="nav-item" role="presentation"><a class="nav-link" href="#">Terms &amp; Use</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="mapify" style="text-align: center">
			<div><p>TopLeft Latitude :</p><input type="number" id="topLeftLat" disabled> <p>TopLeft Longitude :</p><input type="number" id="topLeftLng"  disabled></div>
			<div><p>Marker Latitude :</p><input type="number" id="selectedMarkerLat"> <p>Marker Longitude :</p><input type="number" id="selectedMarkerLng"></div>
			<div><p>BottomRight Latitude :</p><input type="number" id="bottomRightLat" disabled> <p>BottomRight Longitude :</p><input type="number" id="bottomRightLng"  disabled></div>
			<button id="editMode">Edit</button>
			<button id="deleteMarker" class="s">Delete</button>
			<br></br>
			<img class="image" src="static/images/floor_map.png", height = "800px", width="600px"/>
		</div>
		<script type="text/javascript">
		
		(function($) {
			$(document).ready(function() {
				var $markerLat = $("#selectedMarkerLat");
				var $markerLng = $("#selectedMarkerLng");

				var $img = $(".image").mapify({
							topLatLng:{lat:49.285546, lng	:-123.119395},
							botLatLng:{lat:49.284271, lng:-123.117394},
							markersLatLng:[
								{lat: 49.284893, lng: -123.118376, note: "Intersection"},
								{lat: 49.285524, lng: -123.118718, note: "Cactus Club"},
								{lat: 49.285022, lng: -123.118267, note: "Brandi Show Lounge"}
							],
							markerSrc:{
								src:"img/marker.png",
								width:27,
								height:40,
								textColor:'#F0F',
								textSize:15
							},
							zoomable:false,
							onShow: $.noop, //jQuery's default empty function - $.noop
							onAdd: function() {
								this.options.vAll = "bottom";
								this.options.hAll = "middle";
								var elem = $(document.createElement('span')).addClass("marker").html(this.markerCount).attr("title", "");
								var self = this;
								$(elem).tooltip({
									content: function() {
										return $(elem).data("note");
									}
								});
								return elem;
							},
							onDragStart:function(e){},
							onDrag:function(e){ 
								//Display marker's latitude and longitude while dragging onto the textbox
								$markerLat.val(e.target.data("lat"));
								$markerLng.val(e.target.data("lng"));
							},
							onDragStop:function(e){},
							onMarkerClick:function(e){
								//Display marker's current latitude and longitude onto the textbox
								if(e !== null){
									$markerLat.val(e.data("lat"));
									$markerLng.val(e.data("lng"));
								}else{
									$markerLat.val(null);
									$markerLng.val(null);
								}
								
							},
				});

				//Handles toggle mode between Edit/View
				var $toggle = $("#editMode");
				if($img.mapify("option","editMode")){
					$toggle.text("View");
				}else{
					$toggle.text("Edit");
				}
				$toggle.on("click",function(){
					var $this = $(this);
					if($this.text() == "Edit"){
						$this.text("View");
						$img.mapify("option","editMode",true);
					}else{
						$this.text("Edit");
						$img.mapify("option","editMode",false);
						$img.mapify("resetSelected");
					}
				});

				//Handles deleting markers
				var $deleteMarker = $("#deleteMarker");
				$deleteMarker.on("click",function(){
					//Find the selected marker
					$markerArray = $img.mapify("exportMarker");
					$.each($markerArray, function(){ 
						var $elem = $(this); 
						//console.log($elem.data("id"));
						if($elem.data("selected")){
							$img.mapify("deleteMarker",$elem);
							return false;
						}
					}); console.log("done deleting marker");
					
					//$img.mapify("printSelected");//debug 
				});

				//Handles input mode for selected marker
				$markerLat.keyup(function(event){ 
					if(event.which != 46 && event.which != 8 && isNaN(String.fromCharCode(event.which))){
            			event.preventDefault();
        			}else{
        				var $elem = $img.mapify("getSelectedMarker");
        				if($elem != null){
        					$img.mapify("moveMarker", $elem, $markerLat.val(), $markerLng.val());
        				}
        			}
				});
				$markerLng.keyup(function(event){
					if(event.which != 46 && event.which != 8 && isNaN(String.fromCharCode(event.which))){
            			event.preventDefault();
        			}else{
    					var $elem = $img.mapify("getSelectedMarker");
        				if($elem != null){
        					$img.mapify("moveMarker", $elem, $markerLat.val(), $markerLng.val());
        				}
        			}
				});
		  	});
		})(jQuery);
		</script>    <footer class="footer bg-light">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 my-auto h-100 text-center text-lg-left">
                    <ul class="list-inline mb-2">
                        <li class="list-inline-item"><a href="#">About</a></li>
                        <li class="list-inline-item"><span>⋅</span></li>
                        <li class="list-inline-item"><a href="#">Contact</a></li>
                        <li class="list-inline-item"><span>⋅</span></li>
                        <li class="list-inline-item"><a href="#">Terms of &nbsp;Use</a></li>
                        <li class="list-inline-item"><span>⋅</span></li>
                        <li class="list-inline-item"><a href="#">Privacy Policy</a></li>
                    </ul>
                    <p class="text-muted small mb-4 mb-lg-0">© Brand 2018. All Rights Reserved.</p>
                </div>
                <div class="col-lg-6 my-auto h-100 text-center text-lg-right">
                    <ul class="list-inline mb-0">
                        <li class="list-inline-item"><a href="#"><i class="fa fa-facebook fa-2x fa-fw"></i></a></li>
                        <li class="list-inline-item"><a href="#"><i class="fa fa-twitter fa-2x fa-fw"></i></a></li>
                        <li class="list-inline-item"><a href="#"><i class="fa fa-instagram fa-2x fa-fw"></i></a></li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/js/bs-animation.js"></script>
</body>

</html>
